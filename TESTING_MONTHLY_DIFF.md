# 月份選擇差異功能測試指南

> **測試版本：** v2.2.0  
> **測試日期：** 2025-11-24

## 📋 測試前準備

### 環境需求

- 前端開發伺服器運行於 `http://localhost:5173`
- 後端 API 伺服器運行於 `http://localhost:3000`
- Supabase 資料庫已設定完成
- 至少有兩個月份的批次資料

### 測試資料準備

#### 步驟 1：建立測試批次

1. **10月批次**（上月）
   - 以 Admin 身份登入
   - 上傳 Excel 檔案，命名為 `測試片單10月.xlsx`
   - 確認系統識別為 `2024-10`
   - 記錄批次 ID

2. **11月批次**（本月）
   - 上傳另一個 Excel 檔案，命名為 `測試片單11月.xlsx`
   - 確認系統識別為 `2024-11`
   - 確保有部分影片與10月重複（例如片名相同）

#### 步驟 2：建立測試客戶

1. 以 Admin 身份在「用戶管理」中新增測試客戶
2. 記錄測試客戶的帳號密碼

#### 步驟 3：建立上月選擇記錄

1. 以測試客戶身份登入
2. 切換月份為 `2024-10`
3. 選擇 3-5 部影片
4. 提交選擇
5. 確認收到郵件通知

## 🧪 測試案例

### 案例 1：首次選擇（無上月資料）

**測試步驟：**

1. 建立全新的測試客戶
2. 以此客戶登入
3. 進入「影片選擇」頁面

**預期結果：**

- ✅ 不顯示「上月已選片單」區塊
- ✅ 可正常瀏覽本月影片清單
- ✅ 選擇影片後點擊「提交選擇」
- ✅ 不出現確認 Modal，直接提交
- ✅ 顯示成功訊息
- ✅ 管理員收到郵件，但不包含異動摘要

**實際結果：** _[待測試]_

---

### 案例 2：查看上月選擇

**測試步驟：**

1. 以有10月選擇記錄的客戶登入
2. 進入「影片選擇」頁面（預設顯示最新月份）
3. 觀察頁面頂部

**預期結果：**

- ✅ 顯示「上月已選片單」區塊
- ✅ 區塊使用琥珀色主題
- ✅ 顯示正確的影片數量
- ✅ 每部影片顯示縮圖與片名
- ✅ 在本月清單中存在的影片會被預選

**實際結果：** _[待測試]_

---

### 案例 3：上月影片不在本月清單

**測試步驟：**

1. 確認10月選擇中有影片不在11月清單中
2. 觀察「上月已選片單」區塊中該影片的顯示

**預期結果：**

- ✅ 影片卡片顯示「已無法選」標記
- ✅ 游標顯示為禁止圖示
- ✅ 點擊該影片無反應
- ✅ 影片呈現半透明效果

**實際結果：** _[待測試]_

---

### 案例 4：取消上月選擇的影片

**測試步驟：**

1. 在「上月已選片單」區塊中點擊一部在本月清單中仍存在的影片
2. 觀察視覺變化

**預期結果：**

- ✅ 影片卡片移除琥珀色邊框
- ✅ 顯示紅色 X 圖示
- ✅ 卡片呈現半透明效果
- ✅ 底部浮動 Bar 更新已選數量
- ✅ 本月清單中該影片的勾選狀態同步取消

**實際結果：** _[待測試]_

---

### 案例 5：重新選擇已取消的影片

**測試步驟：**

1. 在本月清單中重新點擊剛才取消的影片
2. 觀察變化

**預期結果：**

- ✅ 本月清單中該影片顯示勾選
- ✅ 上月區塊中該影片恢復琥珀色邊框
- ✅ 移除紅色 X 圖示
- ✅ 卡片恢復正常透明度

**實際結果：** _[待測試]_

---

### 案例 6：新增本月影片

**測試步驟：**

1. 在本月清單中選擇一部不在上月選擇中的影片
2. 觀察底部浮動 Bar

**預期結果：**

- ✅ 已選數量增加
- ✅ 影片卡片顯示勾選狀態
- ✅ 不影響上月區塊的顯示

**實際結果：** _[待測試]_

---

### 案例 7：提交前確認 Modal

**測試步驟：**

1. 完成以下操作：
   - 取消上月的 1 部影片（例如 B）
   - 新增本月的 2 部影片（例如 E, F）
2. 點擊「提交選擇」按鈕
3. 觀察 Modal 內容

**預期結果：**

- ✅ 彈出確認 Modal
- ✅ 異動摘要卡片顯示正確數字：
  - 上月總數：3（例如）
  - 本月總數：4（例如）
  - 將下架：1（B）
  - 新增：2（E, F）
  - 保留：2（A, C）
- ✅ 「將下架的影片」區塊列出 B，紅色主題
- ✅ 「新增的影片」區塊列出 E, F，綠色主題
- ✅ 「保留的影片」說明顯示
- ✅ 每部影片顯示縮圖與片名
- ✅ 顯示「返回修改」與「確認送出」按鈕

**實際結果：** _[待測試]_

---

### 案例 8：從確認 Modal 返回修改

**測試步驟：**

1. 開啟確認 Modal
2. 點擊「返回修改」按鈕

**預期結果：**

- ✅ Modal 關閉
- ✅ 回到選擇頁面
- ✅ 已選狀態保持不變
- ✅ 可繼續修改選擇

**實際結果：** _[待測試]_

---

### 案例 9：確認送出

**測試步驟：**

1. 開啟確認 Modal
2. 點擊「確認送出」按鈕
3. 等待提交完成

**預期結果：**

- ✅ 按鈕顯示載入狀態
- ✅ Modal 關閉
- ✅ 顯示成功訊息 Toast
- ✅ 上月區塊消失（因為已建立新的選擇記錄）
- ✅ 管理員收到郵件

**實際結果：** _[待測試]_

---

### 案例 10：郵件通知內容驗證

**測試步驟：**

1. 檢查管理員收到的郵件
2. 驗證郵件內容

**預期結果：**

- ✅ 郵件主旨包含客戶名稱與批次名稱
- ✅ 顯示異動摘要卡片（琥珀色背景）
- ✅ 摘要顯示正確數字：上月/本月總數、下架/新增/保留
- ✅ 本月選擇清單中新增的影片有「新增」綠色標籤
- ✅ 上月選擇清單完整列出所有影片
- ✅ 上月清單中標示「已下架」（紅色）或「保留」（灰色）
- ✅ 影片資訊包含：序號、片名、英文片名、片長、分級

**實際結果：** _[待測試]_

---

### 案例 11：多次提交

**測試步驟：**

1. 完成一次提交
2. 重新進入選擇頁面
3. 修改選擇
4. 再次提交

**預期結果：**

- ✅ 第一次提交後，上月區塊消失
- ✅ 重新進入時，不顯示上月區塊（因為本月已有選擇）
- ✅ 可正常修改與提交
- ✅ 每次提交都發送郵件
- ✅ 資料庫記錄被更新（不是新增）

**實際結果：** _[待測試]_

---

### 案例 12：切換月份

**測試步驟：**

1. 在有上月區塊的狀態下
2. 使用月份選擇器切換到其他月份
3. 再切換回來

**預期結果：**

- ✅ 切換月份時，上月區塊消失
- ✅ 影片清單更新為選定月份
- ✅ 切換回11月時，重新載入上月資料
- ✅ 上月區塊再次顯示

**實際結果：** _[待測試]_

---

### 案例 13：響應式設計

**測試步驟：**

1. 在不同螢幕尺寸下測試（桌面、平板、手機）
2. 檢查各元素的顯示

**預期結果：**

- ✅ 上月區塊在小螢幕上正常顯示（卡片數量自動調整）
- ✅ 確認 Modal 在小螢幕上可滾動
- ✅ 按鈕與文字大小適當
- ✅ 不出現橫向滾動條

**實際結果：** _[待測試]_

---

### 案例 14：效能測試

**測試步驟：**

1. 建立包含 50 部影片的批次
2. 在上月選擇 30 部影片
3. 觀察載入與互動速度

**預期結果：**

- ✅ 上月區塊載入時間 < 2 秒
- ✅ 點擊影片回應即時
- ✅ 確認 Modal 開啟流暢
- ✅ 滾動列表流暢（60fps）

**實際結果：** _[待測試]_

---

### 案例 15：管理員總覽頁面（v2.2.1 新增）

**測試步驟：**

1. 以 Admin 身份登入
2. 點擊導覽列「已選清單」
3. 選擇 11 月份
4. 觀察頁面顯示

**預期結果：**

- ✅ 顯示所有客戶的清單卡片
- ✅ 統計摘要正確（總客戶數、已提交、待提交）
- ✅ 每位客戶顯示提交狀態標籤
- ✅ 展開客戶卡片可查看詳細選擇
- ✅ 異動摘要顯示下架/新增/保留數量
- ✅ 本月選擇標記「新增」影片
- ✅ 上月選擇標記「已下架」或「保留」
- ✅ 搜尋功能可依名稱或 Email 篩選
- ✅ 月份切換正常運作

**實際結果：** _[待測試]_

---

### 案例 16：管理員總覽 - 無資料狀態

**測試步驟：**

1. 選擇一個沒有任何客戶提交的月份
2. 或使用搜尋輸入不存在的客戶名稱

**預期結果：**

- ✅ 顯示「尚無選擇資料」或「找不到符合的客戶」
- ✅ 提供友善的空狀態提示
- ✅ 統計摘要顯示 0

**實際結果：** _[待測試]_

---

## 🐛 Bug 回報格式

如發現問題，請使用以下格式記錄：

```
### Bug #[編號]

**嚴重程度：** [Critical / High / Medium / Low]

**案例編號：** 案例 X

**重現步驟：**
1. ...
2. ...
3. ...

**預期結果：**
...

**實際結果：**
...

**螢幕截圖：**
[附上截圖]

**環境資訊：**
- 瀏覽器：...
- OS：...
- 螢幕尺寸：...
```

## ✅ 測試完成檢查清單

### 客戶端功能
- [ ] 案例 1：首次選擇
- [ ] 案例 2：查看上月選擇
- [ ] 案例 3：上月影片不在本月清單
- [ ] 案例 4：取消上月選擇的影片
- [ ] 案例 5：重新選擇已取消的影片
- [ ] 案例 6：新增本月影片
- [ ] 案例 7：提交前確認 Modal
- [ ] 案例 8：從確認 Modal 返回修改
- [ ] 案例 9：確認送出
- [ ] 案例 10：郵件通知內容驗證
- [ ] 案例 11：多次提交
- [ ] 案例 12：切換月份
- [ ] 案例 13：響應式設計
- [ ] 案例 14：效能測試

### 管理員功能（v2.2.1）
- [ ] 案例 15：管理員總覽頁面
- [ ] 案例 16：管理員總覽 - 無資料狀態

## 📊 測試結果總結

**測試日期：** _[待填寫]_

**測試人員：** _[待填寫]_

**通過率：** _[待計算]_ / 16 (___%)

**發現 Bug 數量：**
- Critical: _[數量]_
- High: _[數量]_
- Medium: _[數量]_
- Low: _[數量]_

**結論：** _[待填寫]_

---

**文件版本：** 1.0  
**最後更新：** 2025-11-24

